<!DOCTYPE html>
<html lang="en">
  <head>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD"
      crossorigin="anonymous"
    />
    <script
      src="https://kit.fontawesome.com/882e525969.js"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN"
      crossorigin="anonymous"
    ></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="stylesheet" href="./css/signIn.css" />
    <title>Login</title>
  </head>
  <body class="text-center">
    <main class="form-signin w-100 m-auto">
      <form>
        <div>
          <img
            id="logo"
            src="./images/Logo.png"
            alt="Logo-Makr-3-Dh-TDI"
            border="0"
          />
        </div>
        <div class="form-floating">
          <input
            type="email"
            class="form-control"
            id="signUpEmail"
            placeholder="name@example.com"
          />
          <label for="floatingInput">Email address</label>
        </div>
        <div class="form-floating">
          <input
            type="password"
            class="form-control"
            id="signUpPassword"
            placeholder="Password"
          />
          <label for="floatingPassword">Password</label>
        </div>
        <button
          class="w-100 btn btn-lg btn-primary"
          type="button"
          onclick="signIn()"
        >
          Login
        </button>
        <a class="btn btn-link" href="/signup"> 회원이 아니신가요?? </a>
      </form>
    </main>

    <script>
      function signUp() {
        let userName = $('#userName').val();
        let password = $('#pw').val();
        let confirm = $('#rePw').val();
        let email = $('#email').val();
        let phone = $('#phone').val();
        let address = $('#address').val();
        let userType = $('input[name=btnradio]:checked').val();
        $.ajax({
          type: 'POST',
          url: '/api/user/signup',
          data: {
            userName,
            password,
            confirm,
            email,
            phone,
            address,
            userType,
          },
          success: function (response) {
            alert(response['message']);
            location.href = '/';
          },
          error: function (response) {
            if ('Validation error' == response['responseJSON'].message) {
              alert('중복된 정보가 있습니다.');
            } else {
              alert(response['responseJSON'].message);
            }
          },
        });
      }

      function signIn() {
        let email = $('#signUpEmail').val();
        let password = $('#signUpPassword').val();
        $.ajax({
          type: 'POST',
          url: '/api/user/login',
          data: { email, password },
          success: function (response) {
            location.href = '/main';
          },
          error: function (err) {
            alert(err.responseJSON.errorMessage);
          },
        });
      }
    </script>
  </body>
</html>
