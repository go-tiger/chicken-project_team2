<header style="margin-bottom: 80px">
  <div class="collapse bg-dark" id="navbarHeader">
    <div class="container">
      <div class="row">
        <div class="header-title col-sm-8 col-md-7 py-4">
          <h4 class="header-title"></h4>
          <p class="header-about"></p>
        </div>
        <div class="col-sm-4 offset-md-1 py-4">
          <h4 class="text-white">Contact</h4>
          <ul class="list-unstyled">
          </ul>
        </div>
      </div>
    </div>
  </div>
  <div class="navbar navbar-dark bg-dark shadow-sm">
    <div class="container">
      <a href="#" class="navbar-brand d-flex align-items-center">
        <strong>정기치킨</strong>
      </a>
      <button
        class="navbar-toggler"
        type="button"
        data-bs-toggle="collapse"
        data-bs-target="#navbarHeader"
        aria-controls="navbarHeader"
        aria-expanded="false"
        aria-label="Toggle navigation"
      >
        <span class="navbar-toggler-icon"></span>
      </button>
    </div>
  </div>
</header>

<script>
  function getTokensFromLocalStorage() {
  const accessToken = localStorage.getItem('accessToken');
  const refreshToken = localStorage.getItem('refreshToken');
  return { accessToken, refreshToken };
  }

  $(document).ready(
    function sendAjaxRequest() {
    const tokens = getTokensFromLocalStorage();
    
    $.ajax({
      type: 'GET',
      url: '/api/user/info',
      headers: {
        'Authorization': `Bearer ${tokens.accessToken}`,
        'Refresh': `${tokens.refreshToken}`
      },
      data: {},
      success: function(response) {
        if(!!response.newAccessToken){
          localStorage.setItem("accessToken", response.newAccessToken);
        }
        const userId = response.userId 
        const userType = response.userType
        const name = response.userName



        if(userType === 0){
          $('.header-title h4').text(name + '님 반갑습니다.')
          $('.about-text p').text('정기치킨은 깨끗한 환경에서 여러분을 모십니다.')
          const headerListHTML = `
            <li><a href="#" class="text-white" onclick="location.href='/menu'">메뉴</a></li>
            <li><a href="#" class="text-white" onclick="location.href='/mypage'">마이페이지</a></li>
            <li><a href="#" class="text-white" onclick="location.href='/cart'">장바구니</a></li>
            <li><a href="#" class="text-white" onclick="location.href='/checkout'">주문정보</a></li>
            <li><a href="#" class="text-white" onclick="signOut()">로그아웃</a></li>
          `
          $('.list-unstyled').append(headerListHTML)
        } else if(userType === 1){
          $('.header-title h4').text(name + '사장님')
          $('.about-text p').text('환영합니다.')
          const headerListHTML = `
            <li><a href="#" class="text-white" onclick="location.href='/orders'">주문관리</a></li>
            <li><a href="#" class="text-white" onclick="location.href='/mypage'">마이페이지</a></li>
            <li><a href="#" class="text-white" onclick="signOut()">로그아웃</a></li>
          `
          $('.list-unstyled').append(headerListHTML)
        } else if(userType === 2){
          $('.header-title h4').text('관리자' + name)
          $('.about-text p').text('내가 주인이다라는 생각으로 일하기')
          const headerListHTML = `
            <li><a href="#" class="text-white" onclick="location.href='/admin/users'">유저관리</a></li>
            <li><a href="#" class="text-white" onclick="location.href='/admin/menu/add'">메뉴 관리</a></li>
            <li><a href="#" class="text-white" onclick="signOut()">로그아웃</a></li>
          `
          $('.list-unstyled').append(headerListHTML)
        }

      },
      error: function(err) {
        alert(err.message)
      }
    });
  }
  )
  


  function signOut() {
    $.ajax({
      type: 'DELETE',
      url: '/logout',
      data: {},
      success: function (response) {
        alert(response['message']);
        location.href = '/';
      },
    });
  }
</script> 
